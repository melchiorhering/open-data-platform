global:
  prefect:
    image:
      repository: prefecthq/prefect
      prefectTag: 3.6.2-python3.12

server:
  # Security: Basic Auth (Optional - currently disabled)
  basicAuth:
    enabled: true
    authString: "admin:pass"
    existingSecret: ""

  priorityClassName: ""
  apiBasePath: "/api"
  debug: false
  loggingLevel: WARNING

  uiConfig:
    # IMPORTANT: This must match the external HTTPS URL + /api
    # This tells the UI where to send requests from your browser.
    prefectUiApiUrl: "https://prefect.localhost/api"
    prefectUiStaticDirectory: "/ui_build"

  # see here for a full list of possible environment variables - https://docs.prefect.io/v3/develop/settings-ref#serversettings
  # -- array with environment variables to add to server deployment
  env:
    - name: PREFECT_SERVER_UI_SHOW_PROMOTIONAL_CONTENT
      value: "False"

# -------------------------------------------------------
# Gateway Configuration
# -------------------------------------------------------
gateway:
  # We disable this because you already created 'internet-gateway' in default
  enabled: false

# -------------------------------------------------------
# HTTPRoute Configuration
# -------------------------------------------------------
httproute:
  enabled: true

  # Define the host for Prefect
  hostnames:
    - "prefect.localhost"

  path: /

  # Attach this route to your existing 'internet-gateway' in 'default'
  parentRefs:
    - name: internet-gateway # Defined in your internet-gateway.yaml
      namespace: default # Gateway is in default, Prefect is in prefect
      # sectionName: https # Attach to the HTTPS listener (Port 443)

  # Labels/Annotations if needed for Cilium
  labels: {}
  annotations: {}

  # Redirect HTTP to HTTPS is handled at the Gateway level usually,
  # but you can leave this default or disable since we attach to HTTPS directly.
  tls:
    redirect: false

# -------------------------------------------------------
# Storage & Messaging
# -------------------------------------------------------
postgresql:
  enabled: false

sqlite:
  enabled: true
  persistence:
    enabled: true
    size: 1Gi

redis:
  enabled: true
  architecture: standalone

# Prevent empty secret errors
secret:
  create: false
